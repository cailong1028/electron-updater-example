'use strict';

var _toConsumableArray2 = require('babel-runtime/helpers/toConsumableArray');

var _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);

var _keys = require('babel-runtime/core-js/object/keys');

var _keys2 = _interopRequireDefault(_keys);

var _typeof2 = require('babel-runtime/helpers/typeof');

var _typeof3 = _interopRequireDefault(_typeof2);

var _assign = require('babel-runtime/core-js/object/assign');

var _assign2 = _interopRequireDefault(_assign);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var isNode = false;
try {
	isNode = Object.prototype.toString.call(global.process) === '[object process]';
} catch (e) {}

function makeTool(xmlParser, Document, Node, NodeList, scopable) {
	var $ = {
		isNode: isNode,
		parseXML: xmlParser,
		extend: _assign2.default,
		isFunction: function isFunction(a) {
			return typeof a === 'function';
		},
		isArray: function isArray(a) {
			return Array.isArray(a);
		},
		each: function each(a, f, ctx) {
			if (Array.isArray(a)) {
				a.forEach(f, ctx);
			} else if ((typeof a === 'undefined' ? 'undefined' : (0, _typeof3.default)(a)) === 'object') {
				(0, _keys2.default)(a).forEach(function (k) {
					f.call(ctx, k, a[k]);
				});
			}
		},
		map: function map(a, f, ctx) {
			return a.map(f, ctx);
		}
	};

	$.extend($, {
		toArray: function toArray(args) {
			var a = [];
			for (var i = 0, len = args.length; i < len; i++) {
				a.push(args[i]);
			}return a;
		}
	});

	var directChildSelector = /((^|,)\s*>)/,
	    id = "sxxx";
	$.extend(Node.prototype, {
		$: function $(selector) {
			if (!directChildSelector.test(selector)) return this.querySelectorAll(selector);else if (scopable) return this.querySelectorAll(selector.split(',').map(function (a) {
				return a.trim().charAt(0) == '>' ? ':scope' + a : a;
			}).join(','));else if (this.id) {
				return this.querySelectorAll(selector.split(',').map(function (a) {
					//return  '#'+this.id+((a=a.trim()).charAt(0)=='>' ? '' : ' ')+a
					return (a = a.trim()).charAt(0) == '>' ? a.substring(1) : a;
				}, this).join(','));
			} else {
				this.id = id;
				var nodes = this.querySelectorAll(selector.split(',').map(function (a) {
					//IE can't find '#xx', @todo: fix it later
					//return  '#'+this.id+((a=a.trim()).charAt(0)=='>' ? '' : ' ')+a
					return (a = a.trim()).charAt(0) == '>' ? a.substring(1) : a;
				}, this).join(','));
				delete this.id;
				return nodes;
			}
		},
		$1: function $1(selector) {
			if (!directChildSelector.test(selector)) return this.querySelector(selector);else if (scopable) return this.querySelector(selector.split(',').map(function (a) {
				return (a = a.trim()).charAt(0) == '>' ? ':scope' + a : a;
			}).join(','));else if (this.id) {
				return this.querySelector(selector.split(',').map(function (a) {
					//return  '#'+this.id+((a=a.trim()).charAt(0)=='>' ? '' : ' ')+a
					return (a = a.trim()).charAt(0) == '>' ? a.substring(1) : a;
				}, this).join(','));
			} else {
				this.id = id;
				var nodes = this.querySelector(selector.split(',').map(function (a) {
					//return  '#'+this.id+((a=a.trim()).charAt(0)=='>' ? '' : ' ')+a
					return (a = a.trim()).charAt(0) == '>' ? a.substring(1) : a;
				}, this).join(','));
				delete this.id;
				return nodes;
			}
		},
		attr: function attr(name, value) {
			if (arguments.length == 1) {
				var attr = this.attributes.getNamedItem(name);
				return attr ? attr.value : undefined;
			} else if (value == null) this.removeAttribute(name);else this.setAttribute(name, value);
		},
		remove: Node.prototype.remove || function () {
			this.parentNode.removeChild(this);
		},
		uptrim: function uptrim() {
			var parent = this.parentNode;
			this.remove();
			if (parent.childNodes.length == 0) parent.uptrim();
		}
	});

	$.extend(NodeList.prototype, {
		asArray: function asArray(o) {
			o = o || [];
			for (var i = 0, len = this.length; i < len; i++) {
				o.push(this[i]);
			}return o;
		},
		forEach: Array.prototype.forEach,
		map: Array.prototype.map
	});

	return $;
}

if (!isNode) {
	window.$ = makeTool.apply(undefined, (0, _toConsumableArray3.default)(function () {
		function parser(x) {
			x = x.trim();
			if (typeof DOMParser != 'undefined') return new DOMParser().parseFromString(x, "text/xml");

			var xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
			xmlDoc.async = "false";
			xmlDoc.loadXML(x);
			return xmlDoc;
		}

		function supportScopeSelector() {
			try {
				return document.body.querySelector(':scope>*').length != 0;
			} catch (e) {
				return false;
			}
		}
		document.$1 = document.querySelector;
		document.$ = document.querySelectorAll;
		return [parser, Document, Element, NodeList, supportScopeSelector()];
	}()));
} else {
	global.$ = makeTool.apply(undefined, (0, _toConsumableArray3.default)(function (xmldom) {
		var DOMParser = xmldom.DOMParser,
		    DOMImplementation = xmldom.DOMImplementation;

		var nwmatcher = require("nwmatcher");

		function parse(x) {
			return new DOMParser().parseFromString(x, "text/xml");
		}

		function addNwmatcher(document) {
			if (!document._nwmatcher) {
				document._nwmatcher = nwmatcher({ document: document });
				document._nwmatcher.configure({ UNIQUE_ID: false });
			}
			return document._nwmatcher;
		}

		var a = parse('<a></a>'),
		    Document = a.constructor,
		    Element = a.documentElement.constructor,
		    NodeList = a.childNodes.constructor;

		Document.prototype.querySelector = Element.prototype.querySelector = function (selector) {
			return addNwmatcher(this.ownerDocument || this).first(selector, this);
		};

		Document.prototype.querySelectorAll = Element.prototype.querySelectorAll = function (selector) {
			return addNwmatcher(this.ownerDocument || this).select(selector, this);
		};

		/**
   * nwwatcher has unexpected result with namespace on nodeName
   */
		var _createElementNS = Document.prototype.createElementNS;
		Document.prototype.createElementNS = function () {
			var el = _createElementNS.apply(this, arguments);
			el.tagName = el.nodeName = el.localName;
			return el;
		};

		Object.defineProperty(Element.prototype, "outerHTML", {
			get: function get() {
				return new xmldom.XMLSerializer().serializeToString(this);
			}
		});

		return [parse, Document, Element, NodeList, false];
	}(require('xmldom'))));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy90b29sLmpzIl0sIm5hbWVzIjpbImlzTm9kZSIsIk9iamVjdCIsInByb3RvdHlwZSIsInRvU3RyaW5nIiwiY2FsbCIsImdsb2JhbCIsInByb2Nlc3MiLCJlIiwibWFrZVRvb2wiLCJ4bWxQYXJzZXIiLCJEb2N1bWVudCIsIk5vZGUiLCJOb2RlTGlzdCIsInNjb3BhYmxlIiwiJCIsInBhcnNlWE1MIiwiZXh0ZW5kIiwiaXNGdW5jdGlvbiIsImEiLCJpc0FycmF5IiwiQXJyYXkiLCJlYWNoIiwiZiIsImN0eCIsImZvckVhY2giLCJrIiwibWFwIiwidG9BcnJheSIsImFyZ3MiLCJpIiwibGVuIiwibGVuZ3RoIiwicHVzaCIsImRpcmVjdENoaWxkU2VsZWN0b3IiLCJpZCIsInNlbGVjdG9yIiwidGVzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJzcGxpdCIsInRyaW0iLCJjaGFyQXQiLCJqb2luIiwic3Vic3RyaW5nIiwibm9kZXMiLCIkMSIsInF1ZXJ5U2VsZWN0b3IiLCJhdHRyIiwibmFtZSIsInZhbHVlIiwiYXJndW1lbnRzIiwiYXR0cmlidXRlcyIsImdldE5hbWVkSXRlbSIsInVuZGVmaW5lZCIsInJlbW92ZUF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsInJlbW92ZSIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsInVwdHJpbSIsInBhcmVudCIsImNoaWxkTm9kZXMiLCJhc0FycmF5IiwibyIsIndpbmRvdyIsInBhcnNlciIsIngiLCJET01QYXJzZXIiLCJwYXJzZUZyb21TdHJpbmciLCJ4bWxEb2MiLCJBY3RpdmVYT2JqZWN0IiwiYXN5bmMiLCJsb2FkWE1MIiwic3VwcG9ydFNjb3BlU2VsZWN0b3IiLCJkb2N1bWVudCIsImJvZHkiLCJFbGVtZW50IiwieG1sZG9tIiwiRE9NSW1wbGVtZW50YXRpb24iLCJud21hdGNoZXIiLCJyZXF1aXJlIiwicGFyc2UiLCJhZGROd21hdGNoZXIiLCJfbndtYXRjaGVyIiwiY29uZmlndXJlIiwiVU5JUVVFX0lEIiwiY29uc3RydWN0b3IiLCJkb2N1bWVudEVsZW1lbnQiLCJvd25lckRvY3VtZW50IiwiZmlyc3QiLCJzZWxlY3QiLCJfY3JlYXRlRWxlbWVudE5TIiwiY3JlYXRlRWxlbWVudE5TIiwiZWwiLCJhcHBseSIsInRhZ05hbWUiLCJub2RlTmFtZSIsImxvY2FsTmFtZSIsImRlZmluZVByb3BlcnR5IiwiZ2V0IiwiWE1MU2VyaWFsaXplciIsInNlcmlhbGl6ZVRvU3RyaW5nIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLFNBQU8sS0FBWDtBQUNBLElBQUk7QUFDSEEsVUFBU0MsT0FBT0MsU0FBUCxDQUFpQkMsUUFBakIsQ0FBMEJDLElBQTFCLENBQStCQyxPQUFPQyxPQUF0QyxNQUFtRCxrQkFBNUQ7QUFDQSxDQUZELENBRUUsT0FBTUMsQ0FBTixFQUFTLENBRVY7O0FBR0QsU0FBU0MsUUFBVCxDQUFrQkMsU0FBbEIsRUFBNkJDLFFBQTdCLEVBQXVDQyxJQUF2QyxFQUE2Q0MsUUFBN0MsRUFBdURDLFFBQXZELEVBQWdFO0FBQy9ELEtBQUlDLElBQUU7QUFDTGQsZ0JBREs7QUFFTGUsWUFBVU4sU0FGTDtBQUdMTywwQkFISztBQUlMQyxjQUFZLG9CQUFTQyxDQUFULEVBQVc7QUFDdEIsVUFBTyxPQUFPQSxDQUFQLEtBQVksVUFBbkI7QUFDQSxHQU5JO0FBT0xDLFdBQVMsaUJBQVNELENBQVQsRUFBVztBQUNuQixVQUFPRSxNQUFNRCxPQUFOLENBQWNELENBQWQsQ0FBUDtBQUNBLEdBVEk7QUFVTEcsUUFBTSxjQUFTSCxDQUFULEVBQVdJLENBQVgsRUFBYUMsR0FBYixFQUFpQjtBQUN0QixPQUFHSCxNQUFNRCxPQUFOLENBQWNELENBQWQsQ0FBSCxFQUFvQjtBQUNuQkEsTUFBRU0sT0FBRixDQUFVRixDQUFWLEVBQVlDLEdBQVo7QUFDQSxJQUZELE1BRU0sSUFBRyxRQUFPTCxDQUFQLHVEQUFPQSxDQUFQLE9BQVksUUFBZixFQUF3QjtBQUM3Qix3QkFBWUEsQ0FBWixF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LE9BQUlDLEtBQUdGLGlCQUFpQkcsS0FBakIsQ0FBdUIsSUFBdkIsRUFBNEI1QyxTQUE1QixDQUFQO0FBQ0EyQyxNQUFHRSxPQUFILEdBQVdGLEdBQUdHLFFBQUgsR0FBWUgsR0FBR0ksU0FBMUI7QUFDQSxVQUFPSixFQUFQO0FBQ0EsR0FKRDs7QUFNQTNGLFNBQU9nRyxjQUFQLENBQXNCdEIsUUFBUXpFLFNBQTlCLEVBQXdDLFdBQXhDLEVBQXFEO0FBQ3BEZ0csUUFBSyxlQUFVO0FBQ2QsV0FBTyxJQUFJdEIsT0FBT3VCLGFBQVgsR0FBMkJDLGlCQUEzQixDQUE2QyxJQUE3QyxDQUFQO0FBQ0E7QUFIbUQsR0FBckQ7O0FBT0EsU0FBTyxDQUFDcEIsS0FBRCxFQUFRdEUsUUFBUixFQUFrQmlFLE9BQWxCLEVBQTJCL0QsUUFBM0IsRUFBcUMsS0FBckMsQ0FBUDtBQUNBLEVBakRvQixDQWlEbEJtRSxRQUFRLFFBQVIsQ0FqRGtCLENBQVosRUFBVDtBQWtEQSIsImZpbGUiOiJ0b29sLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGlzTm9kZT1mYWxzZVxyXG50cnkge1xyXG5cdGlzTm9kZSA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChnbG9iYWwucHJvY2VzcykgPT09ICdbb2JqZWN0IHByb2Nlc3NdJ1xyXG59IGNhdGNoKGUpIHtcclxuXHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBtYWtlVG9vbCh4bWxQYXJzZXIsIERvY3VtZW50LCBOb2RlLCBOb2RlTGlzdCwgc2NvcGFibGUpe1xyXG5cdHZhciAkPXtcclxuXHRcdGlzTm9kZSxcclxuXHRcdHBhcnNlWE1MOiB4bWxQYXJzZXIsXHJcblx0XHRleHRlbmQ6IE9iamVjdC5hc3NpZ24sXHJcblx0XHRpc0Z1bmN0aW9uOiBmdW5jdGlvbihhKXtcclxuXHRcdFx0cmV0dXJuIHR5cGVvZiBhID09PSdmdW5jdGlvbidcclxuXHRcdH0sXHJcblx0XHRpc0FycmF5OiBmdW5jdGlvbihhKXtcclxuXHRcdFx0cmV0dXJuIEFycmF5LmlzQXJyYXkoYSlcclxuXHRcdH0sXHJcblx0XHRlYWNoOiBmdW5jdGlvbihhLGYsY3R4KXtcclxuXHRcdFx0aWYoQXJyYXkuaXNBcnJheShhKSl7XHJcblx0XHRcdFx0YS5mb3JFYWNoKGYsY3R4KVxyXG5cdFx0XHR9ZWxzZSBpZih0eXBlb2YgYSA9PT0nb2JqZWN0Jyl7XHJcblx0XHRcdFx0T2JqZWN0LmtleXMoYSkuZm9yRWFjaChmdW5jdGlvbihrKXtcclxuXHRcdFx0XHRcdGYuY2FsbChjdHgsayxhW2tdKVxyXG5cdFx0XHRcdH0pXHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRtYXA6IGZ1bmN0aW9uKGEsZixjdHgpe1xyXG5cdFx0XHRyZXR1cm4gYS5tYXAoZixjdHgpXHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0JC5leHRlbmQoJCx7XHJcblx0XHR0b0FycmF5OiBmdW5jdGlvbihhcmdzKXtcclxuXHRcdFx0dmFyIGE9W107XHJcblx0XHRcdGZvcih2YXIgaT0wLGxlbj1hcmdzLmxlbmd0aDtpPGxlbjtpKyspXHJcblx0XHRcdFx0YS5wdXNoKGFyZ3NbaV0pXHJcblx0XHRcdHJldHVybiBhXHJcblx0XHR9XHJcblx0fSlcclxuXHJcblx0dmFyIGRpcmVjdENoaWxkU2VsZWN0b3I9LygoXnwsKVxccyo+KS8sIGlkPVwic3h4eFwiXHJcblx0JC5leHRlbmQoTm9kZS5wcm90b3R5cGUse1xyXG5cdFx0JDogZnVuY3Rpb24oc2VsZWN0b3Ipe1xyXG5cdFx0XHRpZighZGlyZWN0Q2hpbGRTZWxlY3Rvci50ZXN0KHNlbGVjdG9yKSlcclxuXHRcdFx0XHRyZXR1cm4gdGhpcy5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKVxyXG5cdFx0XHRlbHNlIGlmKHNjb3BhYmxlKVxyXG5cdFx0XHRcdHJldHVybiB0aGlzLnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3Iuc3BsaXQoJywnKS5tYXAoZnVuY3Rpb24oYSl7XHJcblx0XHRcdFx0XHRcdHJldHVybiBhLnRyaW0oKS5jaGFyQXQoMCk9PSc+JyA/ICc6c2NvcGUnK2EgOiBhXHJcblx0XHRcdFx0XHR9KS5qb2luKCcsJykpXHJcblx0XHRcdGVsc2UgaWYodGhpcy5pZCl7XHJcblx0XHRcdFx0cmV0dXJuIHRoaXMucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvci5zcGxpdCgnLCcpLm1hcChmdW5jdGlvbihhKXtcclxuXHRcdFx0XHRcdFx0Ly9yZXR1cm4gICcjJyt0aGlzLmlkKygoYT1hLnRyaW0oKSkuY2hhckF0KDApPT0nPicgPyAnJyA6ICcgJykrYVxyXG5cdFx0XHRcdFx0XHRyZXR1cm4gKGE9YS50cmltKCkpLmNoYXJBdCgwKT09Jz4nID8gYS5zdWJzdHJpbmcoMSkgOiBhXHJcblx0XHRcdFx0XHR9LHRoaXMpLmpvaW4oJywnKSlcclxuXHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0dGhpcy5pZD1pZFxyXG5cdFx0XHRcdHZhciBub2Rlcz10aGlzLnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3Iuc3BsaXQoJywnKS5tYXAoZnVuY3Rpb24oYSl7XHJcblx0XHRcdFx0XHRcdC8vSUUgY2FuJ3QgZmluZCAnI3h4JywgQHRvZG86IGZpeCBpdCBsYXRlclxyXG5cdFx0XHRcdFx0XHQvL3JldHVybiAgJyMnK3RoaXMuaWQrKChhPWEudHJpbSgpKS5jaGFyQXQoMCk9PSc+JyA/ICcnIDogJyAnKSthXHJcblx0XHRcdFx0XHRcdHJldHVybiAoYT1hLnRyaW0oKSkuY2hhckF0KDApPT0nPicgPyBhLnN1YnN0cmluZygxKSA6IGFcclxuXHRcdFx0XHRcdH0sdGhpcykuam9pbignLCcpKVxyXG5cdFx0XHRcdGRlbGV0ZSB0aGlzLmlkXHJcblx0XHRcdFx0cmV0dXJuIG5vZGVzXHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHQkMTpmdW5jdGlvbihzZWxlY3Rvcil7XHJcblx0XHRcdGlmKCFkaXJlY3RDaGlsZFNlbGVjdG9yLnRlc3Qoc2VsZWN0b3IpKVxyXG5cdFx0XHRcdHJldHVybiB0aGlzLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpXHJcblx0XHRcdGVsc2UgaWYoc2NvcGFibGUpXHJcblx0XHRcdFx0cmV0dXJuIHRoaXMucXVlcnlTZWxlY3RvcihzZWxlY3Rvci5zcGxpdCgnLCcpLm1hcChmdW5jdGlvbihhKXtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIChhPWEudHJpbSgpKS5jaGFyQXQoMCk9PSc+JyA/ICc6c2NvcGUnK2EgOiBhXHJcblx0XHRcdFx0XHR9KS5qb2luKCcsJykpXHJcblx0XHRcdGVsc2UgaWYodGhpcy5pZCl7XHJcblx0XHRcdFx0cmV0dXJuIHRoaXMucXVlcnlTZWxlY3RvcihzZWxlY3Rvci5zcGxpdCgnLCcpLm1hcChmdW5jdGlvbihhKXtcclxuXHRcdFx0XHRcdFx0Ly9yZXR1cm4gICcjJyt0aGlzLmlkKygoYT1hLnRyaW0oKSkuY2hhckF0KDApPT0nPicgPyAnJyA6ICcgJykrYVxyXG5cdFx0XHRcdFx0XHRyZXR1cm4gKGE9YS50cmltKCkpLmNoYXJBdCgwKT09Jz4nID8gYS5zdWJzdHJpbmcoMSkgOiBhXHJcblx0XHRcdFx0XHR9LHRoaXMpLmpvaW4oJywnKSlcclxuXHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0dGhpcy5pZD1pZFxyXG5cdFx0XHRcdHZhciBub2Rlcz10aGlzLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3Iuc3BsaXQoJywnKS5tYXAoZnVuY3Rpb24oYSl7XHJcblx0XHRcdFx0XHRcdC8vcmV0dXJuICAnIycrdGhpcy5pZCsoKGE9YS50cmltKCkpLmNoYXJBdCgwKT09Jz4nID8gJycgOiAnICcpK2FcclxuXHRcdFx0XHRcdFx0cmV0dXJuIChhPWEudHJpbSgpKS5jaGFyQXQoMCk9PSc+JyA/IGEuc3Vic3RyaW5nKDEpIDogYVxyXG5cdFx0XHRcdFx0fSx0aGlzKS5qb2luKCcsJykpXHJcblx0XHRcdFx0ZGVsZXRlIHRoaXMuaWRcclxuXHRcdFx0XHRyZXR1cm4gbm9kZXNcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHRcdGF0dHI6IGZ1bmN0aW9uKG5hbWUsIHZhbHVlKXtcclxuXHRcdFx0aWYoYXJndW1lbnRzLmxlbmd0aD09MSl7XHJcblx0XHRcdFx0dmFyIGF0dHI9dGhpcy5hdHRyaWJ1dGVzLmdldE5hbWVkSXRlbShuYW1lKVxyXG5cdFx0XHRcdHJldHVybiBhdHRyID8gYXR0ci52YWx1ZSA6IHVuZGVmaW5lZFxyXG5cdFx0XHR9ZWxzZSBpZih2YWx1ZT09bnVsbClcclxuXHRcdFx0XHR0aGlzLnJlbW92ZUF0dHJpYnV0ZShuYW1lKVxyXG5cdFx0XHRlbHNlXHJcblx0XHRcdFx0dGhpcy5zZXRBdHRyaWJ1dGUobmFtZSx2YWx1ZSlcclxuXHRcdH0sXHJcblx0XHRyZW1vdmU6IE5vZGUucHJvdG90eXBlLnJlbW92ZSB8fCBmdW5jdGlvbigpe1xyXG5cdFx0XHR0aGlzLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcylcclxuXHRcdH0sXHJcblx0XHR1cHRyaW06IGZ1bmN0aW9uKCl7XHJcblx0XHRcdHZhciBwYXJlbnQ9dGhpcy5wYXJlbnROb2RlXHJcblx0XHRcdHRoaXMucmVtb3ZlKClcclxuXHRcdFx0aWYocGFyZW50LmNoaWxkTm9kZXMubGVuZ3RoPT0wKVxyXG5cdFx0XHRcdHBhcmVudC51cHRyaW0oKVxyXG5cdFx0fVxyXG5cdH0pXHJcblxyXG5cdCQuZXh0ZW5kKE5vZGVMaXN0LnByb3RvdHlwZSx7XHJcblx0XHRhc0FycmF5OiBmdW5jdGlvbihvKXtcclxuXHRcdFx0bz1vfHxbXVxyXG5cdFx0XHRmb3IodmFyIGk9MCxsZW49dGhpcy5sZW5ndGg7aTxsZW47aSsrKVxyXG5cdFx0XHRcdG8ucHVzaCh0aGlzW2ldKVxyXG5cdFx0XHRyZXR1cm4gb1xyXG5cdFx0fSxcclxuXHRcdGZvckVhY2g6IEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLFxyXG5cdFx0bWFwOiBBcnJheS5wcm90b3R5cGUubWFwXHJcblx0fSlcclxuXHJcblx0cmV0dXJuICRcclxufVxyXG5cclxuXHJcbmlmKCFpc05vZGUpe1xyXG5cdHdpbmRvdy4kPW1ha2VUb29sKC4uLihmdW5jdGlvbigpe1xyXG5cdCAgICBmdW5jdGlvbiBwYXJzZXIoeCl7XHJcblx0ICAgICAgICB4PXgudHJpbSgpXHJcblx0ICAgICAgICBpZih0eXBlb2YoRE9NUGFyc2VyKSE9J3VuZGVmaW5lZCcpXHJcblx0ICAgICAgICAgICAgcmV0dXJuICggbmV3IERPTVBhcnNlcigpICkucGFyc2VGcm9tU3RyaW5nKHgsIFwidGV4dC94bWxcIik7XHJcblxyXG5cdCAgICAgICAgdmFyIHhtbERvYyA9IG5ldyBBY3RpdmVYT2JqZWN0KFwiTWljcm9zb2Z0LlhNTERPTVwiKTtcclxuXHQgICAgICAgIHhtbERvYy5hc3luYyA9IFwiZmFsc2VcIjtcclxuXHQgICAgICAgIHhtbERvYy5sb2FkWE1MKHgpO1xyXG5cdCAgICAgICAgcmV0dXJuIHhtbERvYztcclxuXHQgICAgfVxyXG5cclxuXHQgICAgZnVuY3Rpb24gc3VwcG9ydFNjb3BlU2VsZWN0b3IoKXtcclxuXHQgICAgICAgIHRyeXtcclxuXHQgICAgICAgICAgICByZXR1cm4gZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKCc6c2NvcGU+KicpLmxlbmd0aCE9MFxyXG5cdCAgICAgICAgfWNhdGNoKGUpe1xyXG5cdCAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG5cdCAgICAgICAgfVxyXG5cdCAgICB9XHJcblx0ICAgIGRvY3VtZW50LiQxPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JcclxuXHQgICAgZG9jdW1lbnQuJD1kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsXHJcblx0ICAgIHJldHVybiBbcGFyc2VyLCBEb2N1bWVudCwgRWxlbWVudCwgTm9kZUxpc3QsIHN1cHBvcnRTY29wZVNlbGVjdG9yKCldXHJcblx0fSkoKSlcclxufWVsc2V7XHJcblx0Z2xvYmFsLiQ9bWFrZVRvb2woLi4uKGZ1bmN0aW9uKHhtbGRvbSl7XHJcblx0XHR2YXIgRE9NUGFyc2VyPXhtbGRvbS5ET01QYXJzZXIsXHJcblx0XHRcdERPTUltcGxlbWVudGF0aW9uPXhtbGRvbS5ET01JbXBsZW1lbnRhdGlvbjtcclxuXHJcblx0XHR2YXIgbndtYXRjaGVyID0gcmVxdWlyZShcIm53bWF0Y2hlclwiKTtcclxuXHJcblx0XHRmdW5jdGlvbiBwYXJzZSh4KXtcclxuXHRcdFx0cmV0dXJuIG5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcoeCwgXCJ0ZXh0L3htbFwiKVxyXG5cdFx0fVxyXG5cclxuXHRcdGZ1bmN0aW9uIGFkZE53bWF0Y2hlcihkb2N1bWVudCkge1xyXG5cdFx0XHRpZiAoIWRvY3VtZW50Ll9ud21hdGNoZXIpIHtcclxuXHRcdFx0XHRkb2N1bWVudC5fbndtYXRjaGVyID0gbndtYXRjaGVyKHsgZG9jdW1lbnQ6IGRvY3VtZW50IH0pO1xyXG5cdFx0XHRcdGRvY3VtZW50Ll9ud21hdGNoZXIuY29uZmlndXJlKHsgVU5JUVVFX0lEOiBmYWxzZSB9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gZG9jdW1lbnQuX253bWF0Y2hlcjtcclxuXHRcdH1cclxuXHJcblx0XHR2YXIgYT1wYXJzZSgnPGE+PC9hPicpLFxyXG5cdFx0XHREb2N1bWVudD1hLmNvbnN0cnVjdG9yLFxyXG5cdFx0XHRFbGVtZW50PWEuZG9jdW1lbnRFbGVtZW50LmNvbnN0cnVjdG9yLFxyXG5cdFx0XHROb2RlTGlzdD1hLmNoaWxkTm9kZXMuY29uc3RydWN0b3JcclxuXHJcblx0XHREb2N1bWVudC5wcm90b3R5cGUucXVlcnlTZWxlY3Rvcj1FbGVtZW50LnByb3RvdHlwZS5xdWVyeVNlbGVjdG9yPWZ1bmN0aW9uKHNlbGVjdG9yKXtcclxuXHRcdFx0cmV0dXJuIGFkZE53bWF0Y2hlcih0aGlzLm93bmVyRG9jdW1lbnR8fHRoaXMpLmZpcnN0KHNlbGVjdG9yLCB0aGlzKTtcclxuXHRcdH1cclxuXHJcblx0XHREb2N1bWVudC5wcm90b3R5cGUucXVlcnlTZWxlY3RvckFsbD1FbGVtZW50LnByb3RvdHlwZS5xdWVyeVNlbGVjdG9yQWxsPWZ1bmN0aW9uKHNlbGVjdG9yKXtcclxuXHRcdFx0cmV0dXJuIGFkZE53bWF0Y2hlcih0aGlzLm93bmVyRG9jdW1lbnR8fHRoaXMpLnNlbGVjdChzZWxlY3RvciwgdGhpcyk7XHJcblx0XHR9XHJcblxyXG5cdFx0LyoqXHJcblx0XHQgKiBud3dhdGNoZXIgaGFzIHVuZXhwZWN0ZWQgcmVzdWx0IHdpdGggbmFtZXNwYWNlIG9uIG5vZGVOYW1lXHJcblx0XHQgKi9cclxuXHRcdHZhciBfY3JlYXRlRWxlbWVudE5TPURvY3VtZW50LnByb3RvdHlwZS5jcmVhdGVFbGVtZW50TlNcclxuXHRcdERvY3VtZW50LnByb3RvdHlwZS5jcmVhdGVFbGVtZW50TlM9ZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyIGVsPV9jcmVhdGVFbGVtZW50TlMuYXBwbHkodGhpcyxhcmd1bWVudHMpXHJcblx0XHRcdGVsLnRhZ05hbWU9ZWwubm9kZU5hbWU9ZWwubG9jYWxOYW1lXHJcblx0XHRcdHJldHVybiBlbFxyXG5cdFx0fVxyXG5cclxuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFbGVtZW50LnByb3RvdHlwZSxcIm91dGVySFRNTFwiLCB7XHJcblx0XHRcdGdldDogZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRyZXR1cm4gbmV3IHhtbGRvbS5YTUxTZXJpYWxpemVyKCkuc2VyaWFsaXplVG9TdHJpbmcodGhpcylcclxuXHRcdFx0fVxyXG5cdFx0fSlcclxuXHJcblxyXG5cdFx0cmV0dXJuIFtwYXJzZSwgRG9jdW1lbnQsIEVsZW1lbnQsIE5vZGVMaXN0LCBmYWxzZV1cclxuXHR9KShyZXF1aXJlKCd4bWxkb20nKSkpXHJcbn1cclxuIl19