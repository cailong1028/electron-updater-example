'use strict';

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }

var isNode = false;
try {
	isNode = Object.prototype.toString.call(global.process) === '[object process]';
} catch (e) {}

function makeTool(xmlParser, Document, Node, NodeList, scopable) {
	var $ = {
		isNode: isNode,
		parseXML: xmlParser,
		extend: Object.assign,
		isFunction: function isFunction(a) {
			return typeof a === 'function';
		},
		isArray: function isArray(a) {
			return Array.isArray(a);
		},
		each: function each(a, f, ctx) {
			if (Array.isArray(a)) {
				a.forEach(f, ctx);
			} else if ((typeof a === 'undefined' ? 'undefined' : _typeof(a)) === 'object') {
				Object.keys(a).forEach(function (k) {
					f.call(ctx, k, a[k]);
				});
			}
		},
		map: function map(a, f, ctx) {
			return a.map(f, ctx);
		}
	};

	$.extend($, {
		toArray: function toArray(args) {
			var a = [];
			for (var i = 0, len = args.length; i < len; i++) {
				a.push(args[i]);
			}return a;
		}
	});

	var directChildSelector = /((^|,)\s*>)/,
	    id = "sxxx";
	$.extend(Node.prototype, {
		$: function $(selector) {
			if (!directChildSelector.test(selector)) return this.querySelectorAll(selector);else if (scopable) return this.querySelectorAll(selector.split(',').map(function (a) {
				return a.trim().charAt(0) == '>' ? ':scope' + a : a;
			}).join(','));else if (this.id) {
				return this.querySelectorAll(selector.split(',').map(function (a) {
					//return  '#'+this.id+((a=a.trim()).charAt(0)=='>' ? '' : ' ')+a
					return (a = a.trim()).charAt(0) == '>' ? a.substring(1) : a;
				}, this).join(','));
			} else {
				this.id = id;
				var nodes = this.querySelectorAll(selector.split(',').map(function (a) {
					//IE can't find '#xx', @todo: fix it later
					//return  '#'+this.id+((a=a.trim()).charAt(0)=='>' ? '' : ' ')+a
					return (a = a.trim()).charAt(0) == '>' ? a.substring(1) : a;
				}, this).join(','));
				delete this.id;
				return nodes;
			}
		},
		$1: function $1(selector) {
			if (!directChildSelector.test(selector)) return this.querySelector(selector);else if (scopable) return this.querySelector(selector.split(',').map(function (a) {
				return (a = a.trim()).charAt(0) == '>' ? ':scope' + a : a;
			}).join(','));else if (this.id) {
				return this.querySelector(selector.split(',').map(function (a) {
					//return  '#'+this.id+((a=a.trim()).charAt(0)=='>' ? '' : ' ')+a
					return (a = a.trim()).charAt(0) == '>' ? a.substring(1) : a;
				}, this).join(','));
			} else {
				this.id = id;
				var nodes = this.querySelector(selector.split(',').map(function (a) {
					//return  '#'+this.id+((a=a.trim()).charAt(0)=='>' ? '' : ' ')+a
					return (a = a.trim()).charAt(0) == '>' ? a.substring(1) : a;
				}, this).join(','));
				delete this.id;
				return nodes;
			}
		},
		attr: function attr(name, value) {
			if (arguments.length == 1) {
				var attr = this.attributes.getNamedItem(name);
				return attr ? attr.value : undefined;
			} else if (value == null) this.removeAttribute(name);else this.setAttribute(name, value);
		},
		remove: Node.prototype.remove || function () {
			this.parentNode.removeChild(this);
		},
		uptrim: function uptrim() {
			var parent = this.parentNode;
			this.remove();
			if (parent.childNodes.length == 0) parent.uptrim();
		}
	});

	$.extend(NodeList.prototype, {
		asArray: function asArray(o) {
			o = o || [];
			for (var i = 0, len = this.length; i < len; i++) {
				o.push(this[i]);
			}return o;
		},
		forEach: Array.prototype.forEach,
		map: Array.prototype.map
	});

	return $;
}

if (!isNode) {
	window.$ = makeTool.apply(undefined, _toConsumableArray(function () {
		function parser(x) {
			x = x.trim();
			if (typeof DOMParser != 'undefined') return new DOMParser().parseFromString(x, "text/xml");

			var xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
			xmlDoc.async = "false";
			xmlDoc.loadXML(x);
			return xmlDoc;
		}

		function supportScopeSelector() {
			try {
				return document.body.querySelector(':scope>*').length != 0;
			} catch (e) {
				return false;
			}
		}
		document.$1 = document.querySelector;
		document.$ = document.querySelectorAll;
		return [parser, Document, Element, NodeList, supportScopeSelector()];
	}()));
} else {
	global.$ = makeTool.apply(undefined, _toConsumableArray(function (xmldom) {
		var DOMParser = xmldom.DOMParser,
		    DOMImplementation = xmldom.DOMImplementation;

		var nwmatcher = require("nwmatcher");

		function parse(x) {
			return new DOMParser().parseFromString(x, "text/xml");
		}

		function addNwmatcher(document) {
			if (!document._nwmatcher) {
				document._nwmatcher = nwmatcher({ document: document });
				document._nwmatcher.configure({ UNIQUE_ID: false });
			}
			return document._nwmatcher;
		}

		var a = parse('<a></a>'),
		    Document = a.constructor,
		    Element = a.documentElement.constructor,
		    NodeList = a.childNodes.constructor;

		Document.prototype.querySelector = Element.prototype.querySelector = function (selector) {
			return addNwmatcher(this.ownerDocument || this).first(selector, this);
		};

		Document.prototype.querySelectorAll = Element.prototype.querySelectorAll = function (selector) {
			return addNwmatcher(this.ownerDocument || this).select(selector, this);
		};

		/**
   * nwwatcher has unexpected result with namespace on nodeName
   */
		var _createElementNS = Document.prototype.createElementNS;
		Document.prototype.createElementNS = function () {
			var el = _createElementNS.apply(this, arguments);
			el.tagName = el.nodeName = el.localName;
			return el;
		};

		Object.defineProperty(Element.prototype, "outerHTML", {
			get: function get() {
				return new xmldom.XMLSerializer().serializeToString(this);
			}
		});

		return [parse, Document, Element, NodeList, false];
	}(require('xmldom'))));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy90b29sLmpzIl0sIm5hbWVzIjpbImlzTm9kZSIsIk9iamVjdCIsInByb3RvdHlwZSIsInRvU3RyaW5nIiwiY2FsbCIsImdsb2JhbCIsInByb2Nlc3MiLCJlIiwibWFrZVRvb2wiLCJ4bWxQYXJzZXIiLCJEb2N1bWVudCIsIk5vZGUiLCJOb2RlTGlzdCIsInNjb3BhYmxlIiwiJCIsInBhcnNlWE1MIiwiZXh0ZW5kIiwiYXNzaWduIiwiaXNGdW5jdGlvbiIsImEiLCJpc0FycmF5IiwiQXJyYXkiLCJlYWNoIiwiZiIsImN0eCIsImZvckVhY2giLCJrZXlzIiwiayIsIm1hcCIsInRvQXJyYXkiLCJhcmdzIiwiaSIsImxlbiIsImxlbmd0aCIsInB1c2giLCJkaXJlY3RDaGlsZFNlbGVjdG9yIiwiaWQiLCJzZWxlY3RvciIsInRlc3QiLCJxdWVyeVNlbGVjdG9yQWxsIiwic3BsaXQiLCJ0cmltIiwiY2hhckF0Iiwiam9pbiIsInN1YnN0cmluZyIsIm5vZGVzIiwiJDEiLCJxdWVyeVNlbGVjdG9yIiwiYXR0ciIsIm5hbWUiLCJ2YWx1ZSIsImFyZ3VtZW50cyIsImF0dHJpYnV0ZXMiLCJnZXROYW1lZEl0ZW0iLCJ1bmRlZmluZWQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJzZXRBdHRyaWJ1dGUiLCJyZW1vdmUiLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJ1cHRyaW0iLCJwYXJlbnQiLCJjaGlsZE5vZGVzIiwiYXNBcnJheSIsIm8iLCJ3aW5kb3ciLCJwYXJzZXIiLCJ4IiwiRE9NUGFyc2VyIiwicGFyc2VGcm9tU3RyaW5nIiwieG1sRG9jIiwiQWN0aXZlWE9iamVjdCIsImFzeW5jIiwibG9hZFhNTCIsInN1cHBvcnRTY29wZVNlbGVjdG9yIiwiZG9jdW1lbnQiLCJib2R5IiwiRWxlbWVudCIsInhtbGRvbSIsIkRPTUltcGxlbWVudGF0aW9uIiwibndtYXRjaGVyIiwicmVxdWlyZSIsInBhcnNlIiwiYWRkTndtYXRjaGVyIiwiX253bWF0Y2hlciIsImNvbmZpZ3VyZSIsIlVOSVFVRV9JRCIsImNvbnN0cnVjdG9yIiwiZG9jdW1lbnRFbGVtZW50Iiwib3duZXJEb2N1bWVudCIsImZpcnN0Iiwic2VsZWN0IiwiX2NyZWF0ZUVsZW1lbnROUyIsImNyZWF0ZUVsZW1lbnROUyIsImVsIiwiYXBwbHkiLCJ0YWdOYW1lIiwibm9kZU5hbWUiLCJsb2NhbE5hbWUiLCJkZWZpbmVQcm9wZXJ0eSIsImdldCIsIlhNTFNlcmlhbGl6ZXIiLCJzZXJpYWxpemVUb1N0cmluZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBSUEsU0FBTyxLQUFYO0FBQ0EsSUFBSTtBQUNIQSxVQUFTQyxPQUFPQyxTQUFQLENBQWlCQyxRQUFqQixDQUEwQkMsSUFBMUIsQ0FBK0JDLE9BQU9DLE9BQXRDLE1BQW1ELGtCQUE1RDtBQUNBLENBRkQsQ0FFRSxPQUFNQyxDQUFOLEVBQVMsQ0FFVjs7QUFHRCxTQUFTQyxRQUFULENBQWtCQyxTQUFsQixFQUE2QkMsUUFBN0IsRUFBdUNDLElBQXZDLEVBQTZDQyxRQUE3QyxFQUF1REMsUUFBdkQsRUFBZ0U7QUFDL0QsS0FBSUMsSUFBRTtBQUNMZCxnQkFESztBQUVMZSxZQUFVTixTQUZMO0FBR0xPLFVBQVFmLE9BQU9nQixNQUhWO0FBSUxDLGNBQVksb0JBQVNDLENBQVQsRUFBVztBQUN0QixVQUFPLE9BQU9BLENBQVAsS0FBWSxVQUFuQjtBQUNBLEdBTkk7QUFPTEMsV0FBUyxpQkFBU0QsQ0FBVCxFQUFXO0FBQ25CLFVBQU9FLE1BQU1ELE9BQU4sQ0FBY0QsQ0FBZCxDQUFQO0FBQ0EsR0FUSTtBQVVMRyxRQUFNLGNBQVNILENBQVQsRUFBV0ksQ0FBWCxFQUFhQyxHQUFiLEVBQWlCO0FBQ3RCLE9BQUdILE1BQU1ELE9BQU4sQ0FBY0QsQ0FBZCxDQUFILEVBQW9CO0FBQ25CQSxNQUFFTSxPQUFGLENBQVVGLENBQVYsRUFBWUMsR0FBWjtBQUNBLElBRkQsTUFFTSxJQUFHLFFBQU9MLENBQVAseUNBQU9BLENBQVAsT0FBWSxRQUFmLEVBQXdCO0FBQzdC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QW1CMkYsZUFBbkIsR0FBbUMsWUFBVTtBQUM1QyxPQUFJQyxLQUFHRixpQkFBaUJHLEtBQWpCLENBQXVCLElBQXZCLEVBQTRCNUMsU0FBNUIsQ0FBUDtBQUNBMkMsTUFBR0UsT0FBSCxHQUFXRixHQUFHRyxRQUFILEdBQVlILEdBQUdJLFNBQTFCO0FBQ0EsVUFBT0osRUFBUDtBQUNBLEdBSkQ7O0FBTUE3RixTQUFPa0csY0FBUCxDQUFzQnRCLFFBQVEzRSxTQUE5QixFQUF3QyxXQUF4QyxFQUFxRDtBQUNwRGtHLFFBQUssZUFBVTtBQUNkLFdBQU8sSUFBSXRCLE9BQU91QixhQUFYLEdBQTJCQyxpQkFBM0IsQ0FBNkMsSUFBN0MsQ0FBUDtBQUNBO0FBSG1ELEdBQXJEOztBQU9BLFNBQU8sQ0FBQ3BCLEtBQUQsRUFBUXhFLFFBQVIsRUFBa0JtRSxPQUFsQixFQUEyQmpFLFFBQTNCLEVBQXFDLEtBQXJDLENBQVA7QUFDQSxFQWpEb0IsQ0FpRGxCcUUsUUFBUSxRQUFSLENBakRrQixDQUFaLEVBQVQ7QUFrREEiLCJmaWxlIjoidG9vbC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBpc05vZGU9ZmFsc2VcclxudHJ5IHtcclxuXHRpc05vZGUgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZ2xvYmFsLnByb2Nlc3MpID09PSAnW29iamVjdCBwcm9jZXNzXSdcclxufSBjYXRjaChlKSB7XHJcblxyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gbWFrZVRvb2woeG1sUGFyc2VyLCBEb2N1bWVudCwgTm9kZSwgTm9kZUxpc3QsIHNjb3BhYmxlKXtcclxuXHR2YXIgJD17XHJcblx0XHRpc05vZGUsXHJcblx0XHRwYXJzZVhNTDogeG1sUGFyc2VyLFxyXG5cdFx0ZXh0ZW5kOiBPYmplY3QuYXNzaWduLFxyXG5cdFx0aXNGdW5jdGlvbjogZnVuY3Rpb24oYSl7XHJcblx0XHRcdHJldHVybiB0eXBlb2YgYSA9PT0nZnVuY3Rpb24nXHJcblx0XHR9LFxyXG5cdFx0aXNBcnJheTogZnVuY3Rpb24oYSl7XHJcblx0XHRcdHJldHVybiBBcnJheS5pc0FycmF5KGEpXHJcblx0XHR9LFxyXG5cdFx0ZWFjaDogZnVuY3Rpb24oYSxmLGN0eCl7XHJcblx0XHRcdGlmKEFycmF5LmlzQXJyYXkoYSkpe1xyXG5cdFx0XHRcdGEuZm9yRWFjaChmLGN0eClcclxuXHRcdFx0fWVsc2UgaWYodHlwZW9mIGEgPT09J29iamVjdCcpe1xyXG5cdFx0XHRcdE9iamVjdC5rZXlzKGEpLmZvckVhY2goZnVuY3Rpb24oayl7XHJcblx0XHRcdFx0XHRmLmNhbGwoY3R4LGssYVtrXSlcclxuXHRcdFx0XHR9KVxyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0bWFwOiBmdW5jdGlvbihhLGYsY3R4KXtcclxuXHRcdFx0cmV0dXJuIGEubWFwKGYsY3R4KVxyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdCQuZXh0ZW5kKCQse1xyXG5cdFx0dG9BcnJheTogZnVuY3Rpb24oYXJncyl7XHJcblx0XHRcdHZhciBhPVtdO1xyXG5cdFx0XHRmb3IodmFyIGk9MCxsZW49YXJncy5sZW5ndGg7aTxsZW47aSsrKVxyXG5cdFx0XHRcdGEucHVzaChhcmdzW2ldKVxyXG5cdFx0XHRyZXR1cm4gYVxyXG5cdFx0fVxyXG5cdH0pXHJcblxyXG5cdHZhciBkaXJlY3RDaGlsZFNlbGVjdG9yPS8oKF58LClcXHMqPikvLCBpZD1cInN4eHhcIlxyXG5cdCQuZXh0ZW5kKE5vZGUucHJvdG90eXBlLHtcclxuXHRcdCQ6IGZ1bmN0aW9uKHNlbGVjdG9yKXtcclxuXHRcdFx0aWYoIWRpcmVjdENoaWxkU2VsZWN0b3IudGVzdChzZWxlY3RvcikpXHJcblx0XHRcdFx0cmV0dXJuIHRoaXMucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcilcclxuXHRcdFx0ZWxzZSBpZihzY29wYWJsZSlcclxuXHRcdFx0XHRyZXR1cm4gdGhpcy5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yLnNwbGl0KCcsJykubWFwKGZ1bmN0aW9uKGEpe1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gYS50cmltKCkuY2hhckF0KDApPT0nPicgPyAnOnNjb3BlJythIDogYVxyXG5cdFx0XHRcdFx0fSkuam9pbignLCcpKVxyXG5cdFx0XHRlbHNlIGlmKHRoaXMuaWQpe1xyXG5cdFx0XHRcdHJldHVybiB0aGlzLnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3Iuc3BsaXQoJywnKS5tYXAoZnVuY3Rpb24oYSl7XHJcblx0XHRcdFx0XHRcdC8vcmV0dXJuICAnIycrdGhpcy5pZCsoKGE9YS50cmltKCkpLmNoYXJBdCgwKT09Jz4nID8gJycgOiAnICcpK2FcclxuXHRcdFx0XHRcdFx0cmV0dXJuIChhPWEudHJpbSgpKS5jaGFyQXQoMCk9PSc+JyA/IGEuc3Vic3RyaW5nKDEpIDogYVxyXG5cdFx0XHRcdFx0fSx0aGlzKS5qb2luKCcsJykpXHJcblx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdHRoaXMuaWQ9aWRcclxuXHRcdFx0XHR2YXIgbm9kZXM9dGhpcy5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yLnNwbGl0KCcsJykubWFwKGZ1bmN0aW9uKGEpe1xyXG5cdFx0XHRcdFx0XHQvL0lFIGNhbid0IGZpbmQgJyN4eCcsIEB0b2RvOiBmaXggaXQgbGF0ZXJcclxuXHRcdFx0XHRcdFx0Ly9yZXR1cm4gICcjJyt0aGlzLmlkKygoYT1hLnRyaW0oKSkuY2hhckF0KDApPT0nPicgPyAnJyA6ICcgJykrYVxyXG5cdFx0XHRcdFx0XHRyZXR1cm4gKGE9YS50cmltKCkpLmNoYXJBdCgwKT09Jz4nID8gYS5zdWJzdHJpbmcoMSkgOiBhXHJcblx0XHRcdFx0XHR9LHRoaXMpLmpvaW4oJywnKSlcclxuXHRcdFx0XHRkZWxldGUgdGhpcy5pZFxyXG5cdFx0XHRcdHJldHVybiBub2Rlc1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdFx0JDE6ZnVuY3Rpb24oc2VsZWN0b3Ipe1xyXG5cdFx0XHRpZighZGlyZWN0Q2hpbGRTZWxlY3Rvci50ZXN0KHNlbGVjdG9yKSlcclxuXHRcdFx0XHRyZXR1cm4gdGhpcy5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKVxyXG5cdFx0XHRlbHNlIGlmKHNjb3BhYmxlKVxyXG5cdFx0XHRcdHJldHVybiB0aGlzLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3Iuc3BsaXQoJywnKS5tYXAoZnVuY3Rpb24oYSl7XHJcblx0XHRcdFx0XHRcdHJldHVybiAoYT1hLnRyaW0oKSkuY2hhckF0KDApPT0nPicgPyAnOnNjb3BlJythIDogYVxyXG5cdFx0XHRcdFx0fSkuam9pbignLCcpKVxyXG5cdFx0XHRlbHNlIGlmKHRoaXMuaWQpe1xyXG5cdFx0XHRcdHJldHVybiB0aGlzLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3Iuc3BsaXQoJywnKS5tYXAoZnVuY3Rpb24oYSl7XHJcblx0XHRcdFx0XHRcdC8vcmV0dXJuICAnIycrdGhpcy5pZCsoKGE9YS50cmltKCkpLmNoYXJBdCgwKT09Jz4nID8gJycgOiAnICcpK2FcclxuXHRcdFx0XHRcdFx0cmV0dXJuIChhPWEudHJpbSgpKS5jaGFyQXQoMCk9PSc+JyA/IGEuc3Vic3RyaW5nKDEpIDogYVxyXG5cdFx0XHRcdFx0fSx0aGlzKS5qb2luKCcsJykpXHJcblx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdHRoaXMuaWQ9aWRcclxuXHRcdFx0XHR2YXIgbm9kZXM9dGhpcy5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yLnNwbGl0KCcsJykubWFwKGZ1bmN0aW9uKGEpe1xyXG5cdFx0XHRcdFx0XHQvL3JldHVybiAgJyMnK3RoaXMuaWQrKChhPWEudHJpbSgpKS5jaGFyQXQoMCk9PSc+JyA/ICcnIDogJyAnKSthXHJcblx0XHRcdFx0XHRcdHJldHVybiAoYT1hLnRyaW0oKSkuY2hhckF0KDApPT0nPicgPyBhLnN1YnN0cmluZygxKSA6IGFcclxuXHRcdFx0XHRcdH0sdGhpcykuam9pbignLCcpKVxyXG5cdFx0XHRcdGRlbGV0ZSB0aGlzLmlkXHJcblx0XHRcdFx0cmV0dXJuIG5vZGVzXHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRhdHRyOiBmdW5jdGlvbihuYW1lLCB2YWx1ZSl7XHJcblx0XHRcdGlmKGFyZ3VtZW50cy5sZW5ndGg9PTEpe1xyXG5cdFx0XHRcdHZhciBhdHRyPXRoaXMuYXR0cmlidXRlcy5nZXROYW1lZEl0ZW0obmFtZSlcclxuXHRcdFx0XHRyZXR1cm4gYXR0ciA/IGF0dHIudmFsdWUgOiB1bmRlZmluZWRcclxuXHRcdFx0fWVsc2UgaWYodmFsdWU9PW51bGwpXHJcblx0XHRcdFx0dGhpcy5yZW1vdmVBdHRyaWJ1dGUobmFtZSlcclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHRcdHRoaXMuc2V0QXR0cmlidXRlKG5hbWUsdmFsdWUpXHJcblx0XHR9LFxyXG5cdFx0cmVtb3ZlOiBOb2RlLnByb3RvdHlwZS5yZW1vdmUgfHwgZnVuY3Rpb24oKXtcclxuXHRcdFx0dGhpcy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMpXHJcblx0XHR9LFxyXG5cdFx0dXB0cmltOiBmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgcGFyZW50PXRoaXMucGFyZW50Tm9kZVxyXG5cdFx0XHR0aGlzLnJlbW92ZSgpXHJcblx0XHRcdGlmKHBhcmVudC5jaGlsZE5vZGVzLmxlbmd0aD09MClcclxuXHRcdFx0XHRwYXJlbnQudXB0cmltKClcclxuXHRcdH1cclxuXHR9KVxyXG5cclxuXHQkLmV4dGVuZChOb2RlTGlzdC5wcm90b3R5cGUse1xyXG5cdFx0YXNBcnJheTogZnVuY3Rpb24obyl7XHJcblx0XHRcdG89b3x8W11cclxuXHRcdFx0Zm9yKHZhciBpPTAsbGVuPXRoaXMubGVuZ3RoO2k8bGVuO2krKylcclxuXHRcdFx0XHRvLnB1c2godGhpc1tpXSlcclxuXHRcdFx0cmV0dXJuIG9cclxuXHRcdH0sXHJcblx0XHRmb3JFYWNoOiBBcnJheS5wcm90b3R5cGUuZm9yRWFjaCxcclxuXHRcdG1hcDogQXJyYXkucHJvdG90eXBlLm1hcFxyXG5cdH0pXHJcblxyXG5cdHJldHVybiAkXHJcbn1cclxuXHJcblxyXG5pZighaXNOb2RlKXtcclxuXHR3aW5kb3cuJD1tYWtlVG9vbCguLi4oZnVuY3Rpb24oKXtcclxuXHQgICAgZnVuY3Rpb24gcGFyc2VyKHgpe1xyXG5cdCAgICAgICAgeD14LnRyaW0oKVxyXG5cdCAgICAgICAgaWYodHlwZW9mKERPTVBhcnNlcikhPSd1bmRlZmluZWQnKVxyXG5cdCAgICAgICAgICAgIHJldHVybiAoIG5ldyBET01QYXJzZXIoKSApLnBhcnNlRnJvbVN0cmluZyh4LCBcInRleHQveG1sXCIpO1xyXG5cclxuXHQgICAgICAgIHZhciB4bWxEb2MgPSBuZXcgQWN0aXZlWE9iamVjdChcIk1pY3Jvc29mdC5YTUxET01cIik7XHJcblx0ICAgICAgICB4bWxEb2MuYXN5bmMgPSBcImZhbHNlXCI7XHJcblx0ICAgICAgICB4bWxEb2MubG9hZFhNTCh4KTtcclxuXHQgICAgICAgIHJldHVybiB4bWxEb2M7XHJcblx0ICAgIH1cclxuXHJcblx0ICAgIGZ1bmN0aW9uIHN1cHBvcnRTY29wZVNlbGVjdG9yKCl7XHJcblx0ICAgICAgICB0cnl7XHJcblx0ICAgICAgICAgICAgcmV0dXJuIGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvcignOnNjb3BlPionKS5sZW5ndGghPTBcclxuXHQgICAgICAgIH1jYXRjaChlKXtcclxuXHQgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuXHQgICAgICAgIH1cclxuXHQgICAgfVxyXG5cdCAgICBkb2N1bWVudC4kMT1kb2N1bWVudC5xdWVyeVNlbGVjdG9yXHJcblx0ICAgIGRvY3VtZW50LiQ9ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbFxyXG5cdCAgICByZXR1cm4gW3BhcnNlciwgRG9jdW1lbnQsIEVsZW1lbnQsIE5vZGVMaXN0LCBzdXBwb3J0U2NvcGVTZWxlY3RvcigpXVxyXG5cdH0pKCkpXHJcbn1lbHNle1xyXG5cdGdsb2JhbC4kPW1ha2VUb29sKC4uLihmdW5jdGlvbih4bWxkb20pe1xyXG5cdFx0dmFyIERPTVBhcnNlcj14bWxkb20uRE9NUGFyc2VyLFxyXG5cdFx0XHRET01JbXBsZW1lbnRhdGlvbj14bWxkb20uRE9NSW1wbGVtZW50YXRpb247XHJcblxyXG5cdFx0dmFyIG53bWF0Y2hlciA9IHJlcXVpcmUoXCJud21hdGNoZXJcIik7XHJcblxyXG5cdFx0ZnVuY3Rpb24gcGFyc2UoeCl7XHJcblx0XHRcdHJldHVybiBuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKHgsIFwidGV4dC94bWxcIilcclxuXHRcdH1cclxuXHJcblx0XHRmdW5jdGlvbiBhZGROd21hdGNoZXIoZG9jdW1lbnQpIHtcclxuXHRcdFx0aWYgKCFkb2N1bWVudC5fbndtYXRjaGVyKSB7XHJcblx0XHRcdFx0ZG9jdW1lbnQuX253bWF0Y2hlciA9IG53bWF0Y2hlcih7IGRvY3VtZW50OiBkb2N1bWVudCB9KTtcclxuXHRcdFx0XHRkb2N1bWVudC5fbndtYXRjaGVyLmNvbmZpZ3VyZSh7IFVOSVFVRV9JRDogZmFsc2UgfSk7XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIGRvY3VtZW50Ll9ud21hdGNoZXI7XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIGE9cGFyc2UoJzxhPjwvYT4nKSxcclxuXHRcdFx0RG9jdW1lbnQ9YS5jb25zdHJ1Y3RvcixcclxuXHRcdFx0RWxlbWVudD1hLmRvY3VtZW50RWxlbWVudC5jb25zdHJ1Y3RvcixcclxuXHRcdFx0Tm9kZUxpc3Q9YS5jaGlsZE5vZGVzLmNvbnN0cnVjdG9yXHJcblxyXG5cdFx0RG9jdW1lbnQucHJvdG90eXBlLnF1ZXJ5U2VsZWN0b3I9RWxlbWVudC5wcm90b3R5cGUucXVlcnlTZWxlY3Rvcj1mdW5jdGlvbihzZWxlY3Rvcil7XHJcblx0XHRcdHJldHVybiBhZGROd21hdGNoZXIodGhpcy5vd25lckRvY3VtZW50fHx0aGlzKS5maXJzdChzZWxlY3RvciwgdGhpcyk7XHJcblx0XHR9XHJcblxyXG5cdFx0RG9jdW1lbnQucHJvdG90eXBlLnF1ZXJ5U2VsZWN0b3JBbGw9RWxlbWVudC5wcm90b3R5cGUucXVlcnlTZWxlY3RvckFsbD1mdW5jdGlvbihzZWxlY3Rvcil7XHJcblx0XHRcdHJldHVybiBhZGROd21hdGNoZXIodGhpcy5vd25lckRvY3VtZW50fHx0aGlzKS5zZWxlY3Qoc2VsZWN0b3IsIHRoaXMpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogbnd3YXRjaGVyIGhhcyB1bmV4cGVjdGVkIHJlc3VsdCB3aXRoIG5hbWVzcGFjZSBvbiBub2RlTmFtZVxyXG5cdFx0ICovXHJcblx0XHR2YXIgX2NyZWF0ZUVsZW1lbnROUz1Eb2N1bWVudC5wcm90b3R5cGUuY3JlYXRlRWxlbWVudE5TXHJcblx0XHREb2N1bWVudC5wcm90b3R5cGUuY3JlYXRlRWxlbWVudE5TPWZ1bmN0aW9uKCl7XHJcblx0XHRcdHZhciBlbD1fY3JlYXRlRWxlbWVudE5TLmFwcGx5KHRoaXMsYXJndW1lbnRzKVxyXG5cdFx0XHRlbC50YWdOYW1lPWVsLm5vZGVOYW1lPWVsLmxvY2FsTmFtZVxyXG5cdFx0XHRyZXR1cm4gZWxcclxuXHRcdH1cclxuXHJcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoRWxlbWVudC5wcm90b3R5cGUsXCJvdXRlckhUTUxcIiwge1xyXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0cmV0dXJuIG5ldyB4bWxkb20uWE1MU2VyaWFsaXplcigpLnNlcmlhbGl6ZVRvU3RyaW5nKHRoaXMpXHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblxyXG5cclxuXHRcdHJldHVybiBbcGFyc2UsIERvY3VtZW50LCBFbGVtZW50LCBOb2RlTGlzdCwgZmFsc2VdXHJcblx0fSkocmVxdWlyZSgneG1sZG9tJykpKVxyXG59XHJcbiJdfQ==